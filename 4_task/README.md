# Метод конечных элементов

Все вычисления выполнены на Intel Core i7-12650H (2.30 ГГц) с 10 ядрами

### Цель

* Построить приближённое решение краевой задачи методом конечных элементов с кусочно-линейными базисными функциями.
* Провести численный эксперимент и проверить теоретическую оценку о втором порядке сходимости
* Проверить теоретическую оценку ошибки метода конечных элементов.

### Условия

* алгоритм построения онован на [Методы вычислений, Хакимзянов, Черный](http://www.ict.nsc.ru/matmod/files/textbooks/KhakimzyanovCherny-2.pdf)
* $y'' - λy = -2λ * sin(\sqrt{λ}*x)$ - краевая задача, на которой прорводился эксперимент 
* $[0, \frac{3*\pi}{\sqrt{λ}}]$ - отрезок, на котором рассматривается задача
* $y(0)=0$, $y(\frac{8*\pi}{\sqrt{λ}}) = 0$ - граничные условия
* $y(x) = sin(x*\sqrt{λ})$ - явное решение уравнения
* $h$ - шаг сетки (для эксперимента была выбрана равномерная сетка)
* $N$ - количество узлов расчетной сетки

## Эксперимент 1

### Теоретическое ожидание
Теоретическая ошибка взята из пособия [Методы вычислений, Хакимзянов, Черный](http://www.ict.nsc.ru/matmod/files/textbooks/KhakimzyanovCherny-2.pdf). 

Оценка погрешности: 

$$ \|\|y - y_h\|\|\_{L_2(0,l)} \leq (c'c)^2 h^2 \|\|f\|\|\_{L_2(0,l)} $$

Где:
* $c = \frac{1}{c_1} * ((Q \frac{l}{2} + P_1) \frac{l}{2c_1} + 1) = (λ * (l^2) / 4) + 1$
* $c' = J_M * \sqrt{P + Q*l^2/4} = J_M * \sqrt{1 + λ * l^2 / 4}$
* $P = sup(p(x)) = 1$
* $Q = sup(q(x)) = λ$
* $P_1 = max|p'(x)| = 0$
* $p(x) >= c_1 > 0$ ,  $c_1 = 1$

### Результаты

В качетсве тестируемых значений была выбрана сетка с шагом = $h / 100$

`error` $=||y - y_h||_{L_2(0,l)}$

`estimation` $=(c'c)^2 h^2 ||f||_{L_2(0,l)}$
<table>
    <tr>
        <th>N</th>
        <th>λ</th>
        <th>error</th>
        <th>estimation</th>
    </tr>
    <tr>
        <td>10</td>
        <td>1</td>
        <td>1.44</td>
        <td>595</td>
    </tr>
    <tr>
        <td>10</td>
        <td>10</td>
        <td>1.44</td>
        <td>335</td>
    </tr>
    <tr>
        <td>10</td>
        <td>20</td>
        <td>1.44</td>
        <td>281</td>
    </tr>
    <tr>
        <td>50</td>
        <td>1</td>
        <td>0.10</td>
        <td>20</td>
    </tr>
    <tr>
        <td>50</td>
        <td>10</td>
        <td>0.10</td>
        <td>11</td>
    </tr>
    <tr>
        <td>50</td>
        <td>20</td>
        <td>0.10</td>
        <td>9</td>
    </tr>
    <tr>
        <td>100</td>
        <td>1</td>
        <td>0.036</td>
        <td>4.9</td>
    </tr>
    <tr>
        <td>100</td>
        <td>10</td>
        <td>0.036</td>
        <td>2.8</td>
    </tr>
    <tr>
        <td>100</td>
        <td>20</td>
        <td>0.036</td>
        <td>2.3</td>
    </tr>
    <tr>
        <td>10000</td>
        <td>1</td>
        <td>0.0002</td>
        <td>0.0004</td>
    </tr>
    <tr>
        <td>10000</td>
        <td>10</td>
        <td>0.0004</td>
        <td>0.0003</td>
    </tr>
    <tr>
        <td>10000</td>
        <td>20</td>
        <td>0.00024</td>
        <td>0.00023</td>
    </tr>
</table>

Теоретическая оценка не выполняется лишь для сеток с малым шагом ($h = 0.0005$ и $N=10000$).

Отклонение было очень маленьким ( $~0.0001$ ), поэтому можно сказать, что выбранный метод имеет второй порядок сходимости.

## Эксперимент 2

### Теоретическое ожидание
Максимальная ошибка будет того же или меньшего порядка, что и величина $h^2$, где $h \approx 4 * \pi / (\sqrt{λ} * gridSize)$

### Результаты

<table>
    <tr>
        <th>N</th>
        <th>λ</th>
        <th>max error</th>
        <th>$h^2$</th>
    </tr>
    <tr>
        <td>10</td>
        <td>1</td>
        <td>0.094992</td>
        <td>1.096623</td>
    </tr>
    <tr>
        <td>10</td>
        <td>10</td>
        <td>0.094992</td>
        <td>0.109662</td>
    </tr>
    <tr>
        <td>10</td>
        <td>20</td>
        <td>0.094992</td>
        <td>0.054831</td>
    </tr>
    <tr>
        <td>50</td>
        <td>1</td>
        <td>0.003087</td>
        <td>0.036996</td>
    </tr>
    <tr>
        <td>50</td>
        <td>10</td>
        <td>0.003087</td>
        <td>0.003700</td>
    </tr>
    <tr>
        <td>50</td>
        <td>20</td>
        <td>0.003087</td>
        <td>0.001850</td>
    </tr>
    <tr>
        <td>100</td>
        <td>1</td>
        <td>0.000755</td>
        <td>0.009063</td>
    </tr>
    <tr>
        <td>100</td>
        <td>10</td>
        <td>0.000755</td>
        <td>0.000906</td>
    </tr>
    <tr>
        <td>100</td>
        <td>20</td>
        <td>0.000755</td>
        <td>0.000453</td>
    </tr>
</table>

Для $λ$ = 1 и 10 теоретические ожидания сбылись, для $λ$ = 20 нет. Оценка из [книги "Методы вычислений"](http://www.ict.nsc.ru/matmod/files/textbooks/KhakimzyanovCherny-2.pdf) подтверждается, если взять $O(h^2) =h^2 * λ/100$, все ошибки будут ограничены сверху этой границей.